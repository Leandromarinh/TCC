# server {
#   listen 80;

#   location /api/ {
#     proxy_pass http://backend-service.default:8080/;
#   }
  
#   location / {
#     root /usr/share/nginx/html;
#     index index.html index.htm;
#     try_files $uri $uri/ /index.html =404;
#   }
  
#   include /etc/nginx/extra-conf.d/*.conf;
# }

server {
  listen 80;

  location /api/ {
    proxy_pass http://backend-service.default:8080/;
  }

  location / {
    root /usr/share/nginx/html;
    index index.html index.htm;

    # Definir explicitamente os tipos MIME corretos para JavaScript, JSX, e outros arquivos estáticos
    types {
      application/javascript js jsx; # Inclua .jsx para arquivos de React
      text/css               css;
      image/svg+xml          svg;
      application/pdf        pdf;
      text/html              html;
      image/png              png;
      image/jpeg             jpg jpeg;
      image/gif              gif;
    }

    # Tentando os arquivos reais primeiro, redirecionando para index.html se não for encontrado
    try_files $uri $uri/ /index.html =404;
  }

  # Adiciona diretiva para arquivos estáticos (imagens, PDFs, etc.)
  location ~* \.(?:ico|css|js|jsx|gif|jpe?g|png|svg|pdf)$ {
    root /usr/share/nginx/html;
    expires 1y;
    access_log off;
    add_header Cache-Control "public";
  }

  include /etc/nginx/extra-conf.d/*.conf;
}



